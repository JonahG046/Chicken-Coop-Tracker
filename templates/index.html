<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chicken Coop Tracker Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <h1>Chicken Coop Tracker</h1>
    <p>Monitor Feed • Water • Eggs</p>
  </header>

  <nav>
    <a href="{{ url_for('feed') }}">Feed</a>
    <a href="{{ url_for('water') }}">Water</a>
    <a href="{{ url_for('eggs') }}">Eggs</a>
    <a href="{{ url_for('settings') }}">Settings</a>
  </nav>

  <div class="container dashboard">

    <!-- Feed Card -->
    <div class="card">
      <h2>Feed</h2>
      <canvas id="feedChart" width="400" height="200"></canvas>
      <a href="{{ url_for('feed') }}">Go to Feed</a>
    </div>

    <!-- Water Card -->
    <div class="card">
      <h2>Water</h2>
      <canvas id="waterChart" width="400" height="200"></canvas>
      <a href="{{ url_for('water') }}">Go to Water</a>
    </div>

    <!-- Eggs Card -->
    <div class="card">
      <h2>Eggs</h2>
      <canvas id="eggChart" width="400" height="200"></canvas>
      <a href="{{ url_for('eggs') }}">Go to Eggs</a>
    </div>

    <!-- Settings Card -->
    <div class="card">
      <h2>Settings</h2>
      <p>Coop details and preferences</p>
      <a href="{{ url_for('settings') }}">Go to Settings</a>
    </div>

  </div>

  <footer>
    &copy; 2025 Chicken Coop Tracker
  </footer>

  <script>
    // Convert Python dictionaries to JS
    const feedData = {{ feed_data|tojson }};
    const waterData = {{ water_data|tojson }};
    const eggData = {{ egg_data|tojson }};

    function renderChart(ctx, data, label, color) {
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: Object.keys(data),
                datasets: [{
                    label: label,
                    data: Object.values(data),
                    borderColor: color,
                    backgroundColor: 'transparent', // semi-transparent fill
                    fill: false,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
    }

    renderChart(document.getElementById('feedChart').getContext('2d'), feedData, 'Feed (lbs)', 'green');
    renderChart(document.getElementById('waterChart').getContext('2d'), waterData, 'Water (L)', 'blue');
    renderChart(document.getElementById('eggChart').getContext('2d'), eggData, 'Eggs (count)', 'orange');
  </script>
</body>
</html>