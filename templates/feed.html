{% extends "layout.html" %}

{% block content %}
<style>
    /* Restore the card styling so it looks normal */
    .card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        margin: 20px auto;
        max-width: 700px;
    }

    .single-card h2 {
        margin-top: 0;
    }

    .add-btn {
        padding: 10px 16px;
        border: none;
        border-radius: 8px;
        background: #4CAF50;
        color: white;
        cursor: pointer;
        margin-bottom: 20px;
    }

    .add-btn:hover {
        background: #45a049;
    }

    /* Ensures your Chart.js canvas always shows */
    #feedChart {
        width: 100%;
        height: 300px !important;
    }
</style>

<div class="card single-card">
    <h2>Feed Logs</h2>

    <button class="add-btn" onclick="openPopup('{{ url_for('add_feed') }}')">
        Add Feed Log
    </button>

    <canvas id="feedChart"></canvas>
</div>

<script>
    const feedData = {{ feed_data|tojson }};

    new Chart(document.getElementById('feedChart'), {
        type: 'line',
        data: {
            labels: Object.keys(feedData),
            datasets: [{
                label: "Feed (lbs)",
                data: Object.values(feedData),
                borderColor: "green",
                backgroundColor: "transparent",
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,  // important for custom height
            scales: { y: { beginAtZero: true } }
        }
    });
</script>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/popup.js') }}"></script>
{% endblock %}